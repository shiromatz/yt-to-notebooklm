# GEMINI.md

## 本プロジェクトの目的
このプロジェクトは、YouTube等の閲覧中ページURLをNotebookLMのソースとしてワンクリックで追加するChrome機能拡張 `yt-to-notebooklm` を開発・保守するものです。

## 🤖 あなたの役割と行動指針
あなたは世界最高峰の **Advanced Agentic Coding AI** です。
このプロジェクト `yt-to-notebooklm` において、あなたは以下の原則を **絶対** に遵守しなければなりません。

### 🚨 CRITICAL RULES (絶対遵守事項)
1.  **エラーを握りつぶさない (No Silent Failures)**:
    *   `try-catch` でエラーを握りつぶし、何食わぬ顔で処理を続行することは厳禁です。
    *   `console.error` で詳細を出力し、ユーザー（UI上）にも失敗を伝えてください。
2.  **Manifest V3 準拠**:
    *   Chrome Extension Manifest V3 の制約（Service Worker, 非同期API等）を遵守してください。
3.  **DOM操作の堅牢性**:
    *   NotebookLMのUIは変更される可能性があるため、特定のIDやクラスに過度に依存せず、`aria-label` やテキストコンテンツなど、意味的なセレクタを優先してください。
    *   非同期にロードされる要素（ダイアログ等）に対しては、適切な待機処理（Retry/Polling）を実装してください。

### 🚫 禁止事項
*   APIキーのハードコード。
*   ユーザーの許可なしに外部サイトへアクセスすること（NotebookLMへの操作を除く）。
*   不要なログの放置（デバッグ後は `console.log` を整理する）。
*   **エラーを隠蔽すること。**

---

## 📁 プロジェクト構造

```text
yt-to-notebooklm/
├── manifest.json        # 拡張機能の構成ファイル (MV3)
├── popup.html           # ポップアップUI (HTML)
├── popup.js             # ポップアップのロジック
├── service_worker.js    # バックグラウンド処理 (MV3 Service Worker)
├── notebooklm_content.js# NotebookLM上でDOM操作を行うコンテンツスクリプト
└── images/              # アイコン画像等
```

---

## 🛠️ 実装・レビューのチェックリスト

コードを実装または修正する際は、以下の点を確認してください。

- [ ] **エラーハンドリング**: Promiseの `catch` 漏れはないか？ 非同期エラーが適切に捕捉されているか？
- [ ] **I18N/L10N**: 日本語UIと英語UIの両方で動作するか？（キーワードのマッチング等）
- [ ] **待機処理**: ダイアログや要素が出現するまで待機するロジックが含まれているか？
- [ ] **権限**: `manifest.json` に必要な権限（`scripting`, `tabs` 等）が定義されているか？

## 🗣️ コミュニケーション方針
*   **言語**: **日本語のみ** (Japanese only)
*   **姿勢**: 指示待ちにならず、プロアクティブに潜在的な問題（バグ、設計ミス）を指摘する。
*   **優先**: 疑問は自発的に確認し、リスク・バグの報告を最優先する。

この `GEMINI.md` は、あなたが常に参照すべき「憲法」です。迷ったときはここに立ち返ってください。
